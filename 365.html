<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p365" style="overflow: hidden; position: relative; background-color: white; width: 770px; height: 1010px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_365{left:110px;bottom:907px;word-spacing:0.92px;}
#t2_365{left:110px;bottom:888px;letter-spacing:0.01px;word-spacing:3.57px;}
#t3_365{left:110px;bottom:869px;letter-spacing:0.01px;word-spacing:2.85px;}
#t4_365{left:110px;bottom:849px;letter-spacing:0.01px;word-spacing:1.22px;}
#t5_365{left:110px;bottom:830px;letter-spacing:0.01px;word-spacing:0.3px;}
#t6_365{left:110px;bottom:811px;letter-spacing:0.01px;word-spacing:0.01px;}
#t7_365{left:110px;bottom:782px;letter-spacing:-0.01px;word-spacing:0.41px;}
#t8_365{left:110px;bottom:763px;letter-spacing:-0.01px;word-spacing:3.16px;}
#t9_365{left:110px;bottom:743px;letter-spacing:-0.03px;word-spacing:3.01px;}
#ta_365{left:569px;bottom:743px;letter-spacing:0.12px;}
#tb_365{left:110px;bottom:723px;letter-spacing:-0.03px;word-spacing:1.61px;}
#tc_365{left:506px;bottom:723px;letter-spacing:0.12px;}
#td_365{left:610px;bottom:723px;letter-spacing:-0.03px;}
#te_365{left:110px;bottom:704px;letter-spacing:-0.02px;word-spacing:1.27px;}
#tf_365{left:110px;bottom:684px;letter-spacing:-0.01px;word-spacing:2.85px;}
#tg_365{left:110px;bottom:665px;letter-spacing:-0.01px;word-spacing:1.79px;}
#th_365{left:110px;bottom:646px;letter-spacing:-0.02px;word-spacing:0.68px;}
#ti_365{left:110px;bottom:627px;letter-spacing:0.01px;word-spacing:1.34px;}
#tj_365{left:110px;bottom:607px;word-spacing:0.02px;}
#tk_365{left:110px;bottom:579px;letter-spacing:0.01px;word-spacing:0.01px;}
#tl_365{left:123px;bottom:544px;}
#tm_365{left:137px;bottom:544px;letter-spacing:0.03px;word-spacing:-0.01px;}
#tn_365{left:123px;bottom:519px;}
#to_365{left:137px;bottom:519px;letter-spacing:0.02px;}
#tp_365{left:123px;bottom:494px;}
#tq_365{left:137px;bottom:494px;word-spacing:0.02px;}
#tr_365{left:209px;bottom:438px;letter-spacing:-0.15px;word-spacing:1.28px;}
#ts_365{left:209px;bottom:420px;letter-spacing:-0.14px;word-spacing:2.09px;}
#tt_365{left:209px;bottom:403px;letter-spacing:-0.15px;word-spacing:3.42px;}
#tu_365{left:209px;bottom:385px;letter-spacing:-0.15px;word-spacing:3.03px;}
#tv_365{left:209px;bottom:368px;letter-spacing:-0.14px;word-spacing:0.48px;}
#tw_365{left:209px;bottom:350px;letter-spacing:-0.17px;word-spacing:0.56px;}
#tx_365{left:209px;bottom:332px;letter-spacing:-0.17px;word-spacing:4.49px;}
#ty_365{left:209px;bottom:315px;letter-spacing:-0.24px;}
#tz_365{left:110px;bottom:265px;letter-spacing:0.03px;}
#t10_365{left:110px;bottom:240px;letter-spacing:-0.01px;word-spacing:3.26px;}
#t11_365{left:110px;bottom:221px;letter-spacing:-0.01px;word-spacing:0.75px;}
#t12_365{left:110px;bottom:201px;letter-spacing:0.12px;}
#t13_365{left:183px;bottom:201px;letter-spacing:0.02px;word-spacing:1.11px;}
#t14_365{left:110px;bottom:182px;letter-spacing:0.02px;word-spacing:0.09px;}
#t15_365{left:110px;bottom:162px;letter-spacing:0.02px;word-spacing:0.85px;}
#t16_365{left:201px;bottom:162px;letter-spacing:0.12px;}
#t17_365{left:270px;bottom:162px;letter-spacing:0.03px;word-spacing:0.84px;}
#t18_365{left:110px;bottom:142px;letter-spacing:-0.02px;word-spacing:2.77px;}
#t19_365{left:550px;bottom:59px;letter-spacing:-0.08px;}
#t1a_365{left:627px;bottom:59px;}
#t1b_365{left:643px;bottom:59px;letter-spacing:-0.1px;}

.s1_365{font-size:16px;font-family:MinionPro-Regular_7yv;color:#000;}
.s2_365{font-size:15px;font-family:UbuntuMono-Regular_7zr;color:#000;}
.s3_365{font-size:15px;font-family:MinionPro-Regular_7yv;color:#000;}
.s4_365{font-size:24px;font-family:MyriadPro-SemiboldCond_7yc;color:#000;}
.s5_365{font-size:14px;font-family:MyriadPro-SemiboldCond_7yc;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts365" type="text/css" >

@font-face {
	font-family: MinionPro-Regular_7yv;
	src: url("fonts/MinionPro-Regular_7yv.woff") format("woff");
}

@font-face {
	font-family: MyriadPro-SemiboldCond_7yc;
	src: url("fonts/MyriadPro-SemiboldCond_7yc.woff") format("woff");
}

@font-face {
	font-family: UbuntuMono-Regular_7zr;
	src: url("fonts/UbuntuMono-Regular_7zr.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg365Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg365" style="-webkit-user-select: none;"><svg id="pdf365" width="770" height="1010" viewBox="0 0 770 1010" style="width:770px; height:1010px; -moz-transform:scale(1); z-index: 0; isolation: isolate;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
<clipPath id="c0_365"><path d="M110,930.3v-4.7H660v4.7Z"/></clipPath>
<style type="text/css"><![CDATA[
.g0_365{
fill: none;
stroke: #000;
stroke-width: 0.381;
stroke-linecap: round;
stroke-miterlimit: 10;
}
]]></style>
</defs>
<path clip-path="url(#c0_365)" d="M660,927.9H110" class="g0_365"/>
<image preserveAspectRatio="none" x="133" y="555" width="57" height="66" xlink:href="365/img/1.jpg"/>
</svg></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_365" class="t s1_365">there is no way for that exception to propagate back to the initiator of the asynchro‐ </span>
<span id="t2_365" class="t s1_365">nous operation. This is a fundamental fact about asynchronous programming: it </span>
<span id="t3_365" class="t s1_365">breaks exception handling. The alternative is to meticulously track and propagate </span>
<span id="t4_365" class="t s1_365">errors with callback arguments and return values, but this is tedious and difficult to </span>
<span id="t5_365" class="t s1_365">get right. Promises help here by standardizing a way to handle errors and providing a </span>
<span id="t6_365" class="t s1_365">way for errors to propagate correctly through a chain of promises. </span>
<span id="t7_365" class="t s1_365">Note that Promises represent the future results of single asynchronous computations. </span>
<span id="t8_365" class="t s1_365">They cannot be used to represent repeated asynchronous computations, however. </span>
<span id="t9_365" class="t s1_365">Later in this chapter, we’ll write a Promise-based alternative to the </span><span id="ta_365" class="t s2_365">setTimeout() </span>
<span id="tb_365" class="t s1_365">function, for example. But we can’t use Promises to replace </span><span id="tc_365" class="t s2_365">setInterval() </span><span id="td_365" class="t s1_365">because </span>
<span id="te_365" class="t s1_365">that function invokes a callback function repeatedly, which is something that Prom‐ </span>
<span id="tf_365" class="t s1_365">ises are just not designed to do. Similarly, we could use a Promise instead of the </span>
<span id="tg_365" class="t s1_365">“load” event handler of an XMLHttpRequest object, since that callback is only ever </span>
<span id="th_365" class="t s1_365">called once. But we typically would not use a Promise in place of a “click” event han‐ </span>
<span id="ti_365" class="t s1_365">dler of an HTML button object, since we normally want to allow the user to click a </span>
<span id="tj_365" class="t s1_365">button multiple times. </span>
<span id="tk_365" class="t s1_365">The subsections that follow will: </span>
<span id="tl_365" class="t s1_365">• </span><span id="tm_365" class="t s1_365">Explain Promise terminology and show basic Promise usage </span>
<span id="tn_365" class="t s1_365">• </span><span id="to_365" class="t s1_365">Show how promises can be chained </span>
<span id="tp_365" class="t s1_365">• </span><span id="tq_365" class="t s1_365">Demonstrate how to create your own Promise-based APIs </span>
<span id="tr_365" class="t s3_365">Promises seem simple at first, and the basic use case for Promises </span>
<span id="ts_365" class="t s3_365">is, in fact, straightforward and simple. But they can become sur‐ </span>
<span id="tt_365" class="t s3_365">prisingly confusing for anything beyond the simplest use cases. </span>
<span id="tu_365" class="t s3_365">Promises are a powerful idiom for asynchronous programming, </span>
<span id="tv_365" class="t s3_365">but you need to understand them deeply to use them correctly and </span>
<span id="tw_365" class="t s3_365">confidently. It is worth taking the time to develop that deep under‐ </span>
<span id="tx_365" class="t s3_365">standing, however, and I urge you to study this long chapter </span>
<span id="ty_365" class="t s3_365">carefully. </span>
<span id="tz_365" class="t s4_365">13.2.1 Using Promises </span>
<span id="t10_365" class="t s1_365">With the advent of Promises in the core JavaScript language, web browsers have </span>
<span id="t11_365" class="t s1_365">begun to implement Promise-based APIs. In the previous section, we implemented a </span>
<span id="t12_365" class="t s2_365">getText() </span><span id="t13_365" class="t s1_365">function that made an asynchronous HTTP request and passed the body </span>
<span id="t14_365" class="t s1_365">of the HTTP response to a specified callback function as a string. Imagine a variant of </span>
<span id="t15_365" class="t s1_365">this function, </span><span id="t16_365" class="t s2_365">getJSON()</span><span id="t17_365" class="t s1_365">, which parses the body of the HTTP response as JSON and </span>
<span id="t18_365" class="t s1_365">returns a Promise instead of accepting a callback argument. We will implement a </span>
<span id="t19_365" class="t s5_365">13.2 Promises </span><span id="t1a_365" class="t s5_365">| </span><span id="t1b_365" class="t s5_365">347 </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
