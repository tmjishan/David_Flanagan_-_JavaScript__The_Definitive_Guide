<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta charset="utf-8" />
</head>

<body style="margin: 0;">

<div id="p531" style="overflow: hidden; position: relative; background-color: white; width: 770px; height: 1010px;">

<!-- Begin shared CSS values -->
<style class="shared-css" type="text/css" >
.t {
	transform-origin: bottom left;
	z-index: 2;
	position: absolute;
	white-space: pre;
	overflow: visible;
	line-height: 1.5;
}
.text-container {
	white-space: pre;
}
@supports (-webkit-touch-callout: none) {
	.text-container {
		white-space: normal;
	}
}
</style>
<!-- End shared CSS values -->


<!-- Begin inline CSS -->
<style type="text/css" >

#t1_531{left:110px;bottom:899px;letter-spacing:0.03px;}
#t2_531{left:110px;bottom:875px;letter-spacing:0.02px;word-spacing:0.68px;}
#t3_531{left:110px;bottom:856px;word-spacing:1.61px;}
#t4_531{left:110px;bottom:836px;letter-spacing:0.02px;word-spacing:0.77px;}
#t5_531{left:239px;bottom:836px;letter-spacing:0.12px;}
#t6_531{left:389px;bottom:836px;letter-spacing:-0.05px;word-spacing:0.83px;}
#t7_531{left:110px;bottom:815px;letter-spacing:-0.02px;word-spacing:0.69px;}
#t8_531{left:336px;bottom:816px;letter-spacing:0.12px;}
#t9_531{left:485px;bottom:815px;word-spacing:0.67px;}
#ta_531{left:110px;bottom:796px;letter-spacing:-0.02px;word-spacing:2.88px;}
#tb_531{left:110px;bottom:777px;letter-spacing:-0.03px;word-spacing:1.98px;}
#tc_531{left:110px;bottom:758px;word-spacing:1.85px;}
#td_531{left:110px;bottom:738px;letter-spacing:-0.01px;word-spacing:0.23px;}
#te_531{left:110px;bottom:719px;letter-spacing:-0.01px;word-spacing:0.02px;}
#tf_531{left:110px;bottom:690px;word-spacing:0.43px;}
#tg_531{left:253px;bottom:690px;letter-spacing:0.12px;}
#th_531{left:341px;bottom:690px;letter-spacing:-0.01px;word-spacing:0.44px;}
#ti_531{left:110px;bottom:671px;letter-spacing:0.01px;word-spacing:2.79px;}
#tj_531{left:110px;bottom:650px;letter-spacing:-0.72px;}
#tk_531{left:166px;bottom:650px;letter-spacing:-0.09px;word-spacing:1.82px;}
#tl_531{left:273px;bottom:650px;letter-spacing:0.01px;word-spacing:1.73px;}
#tm_531{left:538px;bottom:651px;letter-spacing:0.12px;}
#tn_531{left:110px;bottom:631px;letter-spacing:-0.01px;word-spacing:0.03px;}
#to_531{left:110px;bottom:603px;word-spacing:0.08px;}
#tp_531{left:110px;bottom:584px;letter-spacing:0.01px;word-spacing:0.3px;}
#tq_531{left:110px;bottom:564px;word-spacing:1.84px;}
#tr_531{left:110px;bottom:545px;letter-spacing:0.01px;word-spacing:1.51px;}
#ts_531{left:110px;bottom:526px;letter-spacing:-0.01px;word-spacing:3.37px;}
#tt_531{left:110px;bottom:507px;letter-spacing:-0.01px;word-spacing:1.46px;}
#tu_531{left:110px;bottom:487px;letter-spacing:-0.05px;word-spacing:1.13px;}
#tv_531{left:110px;bottom:468px;letter-spacing:-0.03px;word-spacing:0.04px;}
#tw_531{left:110px;bottom:449px;letter-spacing:0.02px;}
#tx_531{left:267px;bottom:392px;letter-spacing:-0.03px;}
#ty_531{left:123px;bottom:369px;letter-spacing:0.11px;}
#tz_531{left:151px;bottom:370px;letter-spacing:-0.24px;}
#t10_531{left:293px;bottom:369px;letter-spacing:0.12px;word-spacing:0.58px;}
#t11_531{left:425px;bottom:370px;letter-spacing:-0.24px;}
#t12_531{left:546px;bottom:369px;}
#t13_531{left:551px;bottom:369px;letter-spacing:0.12px;}
#t14_531{left:584px;bottom:369px;letter-spacing:0.1px;word-spacing:0.58px;}
#t15_531{left:123px;bottom:351px;letter-spacing:0.08px;word-spacing:0.69px;}
#t16_531{left:123px;bottom:333px;letter-spacing:0.11px;word-spacing:2px;}
#t17_531{left:123px;bottom:314px;letter-spacing:0.13px;}
#t18_531{left:123px;bottom:286px;letter-spacing:0.1px;word-spacing:2.49px;}
#t19_531{left:500px;bottom:286px;letter-spacing:-0.24px;}
#t1a_531{left:622px;bottom:286px;letter-spacing:0.11px;}
#t1b_531{left:123px;bottom:268px;letter-spacing:0.08px;word-spacing:0.47px;}
#t1c_531{left:123px;bottom:249px;letter-spacing:0.09px;word-spacing:0.1px;}
#t1d_531{left:123px;bottom:231px;letter-spacing:0.11px;word-spacing:0.72px;}
#t1e_531{left:425px;bottom:231px;letter-spacing:-0.06px;}
#t1f_531{left:470px;bottom:231px;letter-spacing:0.1px;word-spacing:0.72px;}
#t1g_531{left:123px;bottom:213px;letter-spacing:0.1px;word-spacing:0.45px;}
#t1h_531{left:123px;bottom:194px;letter-spacing:0.11px;word-spacing:1.44px;}
#t1i_531{left:123px;bottom:176px;letter-spacing:0.09px;word-spacing:0.75px;}
#t1j_531{left:123px;bottom:158px;letter-spacing:0.1px;word-spacing:0.02px;}
#t1k_531{left:123px;bottom:129px;letter-spacing:0.09px;word-spacing:0.86px;}
#t1l_531{left:398px;bottom:130px;letter-spacing:-0.24px;}
#t1m_531{left:540px;bottom:129px;letter-spacing:0.11px;word-spacing:0.84px;}
#t1n_531{left:123px;bottom:110px;letter-spacing:0.09px;word-spacing:0.09px;}
#t1o_531{left:434px;bottom:110px;letter-spacing:-0.24px;}
#t1p_531{left:554px;bottom:110px;letter-spacing:0.08px;word-spacing:0.03px;}
#t1q_531{left:435px;bottom:59px;letter-spacing:-0.08px;}
#t1r_531{left:627px;bottom:59px;}
#t1s_531{left:643px;bottom:59px;letter-spacing:-0.1px;}

.s1_531{font-size:24px;font-family:MyriadPro-SemiboldCond_7yc;color:#000;}
.s2_531{font-size:16px;font-family:MinionPro-Regular_7yv;color:#000;}
.s3_531{font-size:15px;font-family:UbuntuMono-Regular_7zr;color:#000;}
.s4_531{font-size:16px;font-family:MinionPro-It_7xz;color:#000;}
.s5_531{font-size:23px;font-family:MyriadPro-SemiboldCond_7yc;color:#000;}
.s6_531{font-size:15px;font-family:MinionPro-Regular_7yv;color:#000;}
.s7_531{font-size:15px;font-family:MinionPro-Regular_7yv;color:#900;}
.s8_531{font-size:15px;font-family:MinionPro-It_7xz;color:#000;}
.s9_531{font-size:14px;font-family:MyriadPro-SemiboldCond_7yc;color:#000;}
</style>
<!-- End inline CSS -->

<!-- Begin embedded font definitions -->
<style id="fonts531" type="text/css" >

@font-face {
	font-family: MinionPro-It_7xz;
	src: url("fonts/MinionPro-It_7xz.woff") format("woff");
}

@font-face {
	font-family: MinionPro-Regular_7yv;
	src: url("fonts/MinionPro-Regular_7yv.woff") format("woff");
}

@font-face {
	font-family: MyriadPro-SemiboldCond_7yc;
	src: url("fonts/MyriadPro-SemiboldCond_7yc.woff") format("woff");
}

@font-face {
	font-family: UbuntuMono-Regular_7zr;
	src: url("fonts/UbuntuMono-Regular_7zr.woff") format("woff");
}

</style>
<!-- End embedded font definitions -->

<!-- Begin page background -->
<div id="pg531Overlay" style="width:100%; height:100%; position:absolute; z-index:1; background-color:rgba(0,0,0,0); -webkit-user-select: none;"></div>
<div id="pg531" style="-webkit-user-select: none;"><svg id="pdf531" width="770" height="1010" viewBox="0 0 770 1010" style="width:770px; height:1010px; -moz-transform:scale(1); z-index: 0; isolation: isolate;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<defs>
<clipPath id="c0_531"><path d="M110,930.3v-4.7H660v4.7Z"/></clipPath>
<clipPath id="c1_531"><path d="M111.3,577.8l-1.2,-2.3l-1.2,-2.4H661.1l-1.2,2.4l-1.2,2.3Z"/></clipPath>
<clipPath id="c2_531"><path d="M657.5,905.7V576.6l2.3,-1.2l2.4,-1.2V905.7Z"/></clipPath>
<clipPath id="c3_531"><path d="M107.8,905.7V574.2l2.4,1.2l2.3,1.2V905.7Z"/></clipPath>
<style type="text/css"><![CDATA[
.g0_531{
fill: none;
stroke: #000;
stroke-width: 0.381;
stroke-linecap: round;
stroke-miterlimit: 10;
}
]]></style>
</defs>
<path clip-path="url(#c0_531)" d="M660,927.9H110" class="g0_531"/>
<path clip-path="url(#c1_531)" d="M110,575.5H660" class="g0_531"/>
<path clip-path="url(#c2_531)" d="M659.8,575.3V905.7" class="g0_531"/>
<path clip-path="url(#c3_531)" d="M110.2,905.7V575.3" class="g0_531"/>
</svg></div>
<!-- End page background -->


<!-- Begin text definitions (Positioned/styled in CSS) -->
<div class="text-container"><span id="t1_531" class="t s1_531">15.10.4 History Management with pushState() </span>
<span id="t2_531" class="t s2_531">The second technique for managing history is somewhat more complex but is less of </span>
<span id="t3_531" class="t s2_531">a hack than the “hashchange” event. This more robust history-management techni‐ </span>
<span id="t4_531" class="t s2_531">que is based on the </span><span id="t5_531" class="t s3_531">history.pushState() </span><span id="t6_531" class="t s2_531">method and the “popstate” event. When a </span>
<span id="t7_531" class="t s2_531">web app enters a new state, it calls </span><span id="t8_531" class="t s3_531">history.pushState() </span><span id="t9_531" class="t s2_531">to add an object represent‐ </span>
<span id="ta_531" class="t s2_531">ing the state to the browser’s history. If the user then clicks the Back button, the </span>
<span id="tb_531" class="t s2_531">browser fires a “popstate” event with a copy of that saved state object, and the app </span>
<span id="tc_531" class="t s2_531">uses that object to re-create its previous state. In addition to the saved state object, </span>
<span id="td_531" class="t s2_531">applications can also save a URL with each state, which is important if you want users </span>
<span id="te_531" class="t s2_531">to be able to bookmark and share links to the internal states of the app. </span>
<span id="tf_531" class="t s2_531">The first argument to </span><span id="tg_531" class="t s3_531">pushState() </span><span id="th_531" class="t s2_531">is an object that contains all the state information </span>
<span id="ti_531" class="t s2_531">necessary to restore the current state of the document. This object is saved using </span>
<span id="tj_531" class="t s2_531">HTML’s </span><span id="tk_531" class="t s4_531">structured clone </span><span id="tl_531" class="t s2_531">algorithm, which is more versatile than </span><span id="tm_531" class="t s3_531">JSON.stringify() </span>
<span id="tn_531" class="t s2_531">and can support Map, Set, and Date objects as well as typed arrays and ArrayBuffers. </span>
<span id="to_531" class="t s2_531">The second argument was intended to be a title string for the state, but most browsers </span>
<span id="tp_531" class="t s2_531">do not support it, and you should just pass an empty string. The third argument is an </span>
<span id="tq_531" class="t s2_531">optional URL that will be displayed in the location bar immediately and also if the </span>
<span id="tr_531" class="t s2_531">user returns to this state via Back and Forward buttons. Relative URLs are resolved </span>
<span id="ts_531" class="t s2_531">against the current location of the document. Associating a URL with each state </span>
<span id="tt_531" class="t s2_531">allows the user to bookmark internal states of your application. Remember, though, </span>
<span id="tu_531" class="t s2_531">that if the user saves a bookmark and then visits it a day later, you won’t get a “pop‐ </span>
<span id="tv_531" class="t s2_531">state” event about that visit: you’ll have to restore your application state by parsing the </span>
<span id="tw_531" class="t s2_531">URL. </span>
<span id="tx_531" class="t s5_531">The Structured Clone Algorithm </span>
<span id="ty_531" class="t s6_531">The </span><span id="tz_531" class="t s3_531">history.pushState() </span><span id="t10_531" class="t s6_531">method does not use </span><span id="t11_531" class="t s3_531">JSON.stringify() </span><span id="t12_531" class="t s6_531">(</span><span id="t13_531" class="t s7_531">§11.6</span><span id="t14_531" class="t s6_531">) to serial‐ </span>
<span id="t15_531" class="t s6_531">ize state data. Instead, it (and other browser APIs we’ll learn about later) uses a more </span>
<span id="t16_531" class="t s6_531">robust serialization technique known as the structured clone algorithm, defined by </span>
<span id="t17_531" class="t s6_531">the HTML standard. </span>
<span id="t18_531" class="t s6_531">The structured clone algorithm can serialize anything that </span><span id="t19_531" class="t s3_531">JSON.stringify() </span><span id="t1a_531" class="t s6_531">can, </span>
<span id="t1b_531" class="t s6_531">but in addition, it enables serialization of most other JavaScript types, including Map, </span>
<span id="t1c_531" class="t s6_531">Set, Date, RegExp, and typed arrays, and it can handle data structures that include cir‐ </span>
<span id="t1d_531" class="t s6_531">cular references. The structured clone algorithm </span><span id="t1e_531" class="t s8_531">cannot </span><span id="t1f_531" class="t s6_531">serialize functions or classes, </span>
<span id="t1g_531" class="t s6_531">however. When cloning objects it does not copy the prototype object, getters and set‐ </span>
<span id="t1h_531" class="t s6_531">ters, or non-enumerable properties. While the structured clone algorithm can clone </span>
<span id="t1i_531" class="t s6_531">most built-in JavaScript types, it cannot copy types defined by the host environment, </span>
<span id="t1j_531" class="t s6_531">such as document Element objects. </span>
<span id="t1k_531" class="t s6_531">This means that the state object you pass to </span><span id="t1l_531" class="t s3_531">history.pushState() </span><span id="t1m_531" class="t s6_531">need not be limi‐ </span>
<span id="t1n_531" class="t s6_531">ted to the objects, arrays, and primitive values that </span><span id="t1o_531" class="t s3_531">JSON.stringify() </span><span id="t1p_531" class="t s6_531">supports. Note, </span>
<span id="t1q_531" class="t s9_531">15.10 Location, Navigation, and History </span><span id="t1r_531" class="t s9_531">| </span><span id="t1s_531" class="t s9_531">513 </span></div>
<!-- End text definitions -->


</div>
</body>
</html>
